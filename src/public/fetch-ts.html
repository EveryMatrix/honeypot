<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>fetching ts2</title>
    <script
            src="https://code.jquery.com/jquery-2.2.4.min.js"
            integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
            crossorigin="anonymous"></script>
</head>
<body>
<h1>Fetching ts2 data</h1>
<pre id="response"></pre>
<h2>Log here:</h2>
<pre id="log"></pre>
<script>
    document.getElementById('log').innerHTML = 'works';
    // var logstr = [];
    //
    // function log(m, l) {
    //     logstr.push({message: m, log: l});
    //     document.getElementById('log').innerHTML = JSON.stringify(logstr, false, 4);
    //
    // }
    //
    // if (window) {
    //     window.addEventListener('error', (e) => {
    //         log('window error', {
    //             message: e.message,
    //             stack: e.error.stack,
    //             timestamp: parseInt(e.timeStamp, 10),
    //         });
    //     });
    // }
    //
    // function sendLog(r) {
    //     log('sendLog', r);
    //     var body = JSON.stringify(r, false, 4);
    //     document.getElementById('response').innerHTML = body;
    //     jQuery.ajax({
    //         url: '/add-sendLog',
    //         type: 'POST',
    //         data: body,
    //         dataType: 'jsonp',
    //         headers: {
    //             'content-type': 'application/json'
    //         },
    //     });
    // }
    //
    // function fetchData(url, cb, ecb) {
    //     jQuery.ajax({
    //             url,
    //             success: (data) => {
    //                 log('success ajax', {url, data});
    //                 cb(data);
    //             },
    //             error: (request, status, error) => {
    //                 log('error ajax', {url, request, status, error});
    //                 ecb({request, error, status});
    //             }
    //
    //         }
    //     )
    // }
    //
    //
    // log('before ts ajax');
    // fetchData('https://api-dev.everymatrix.com/longpoll/open', sendLog, sendLog);
    // log('before self ajax');
    // var selfCB = log.bind(null, 'self ajax');
    // fetchData('demo', selfCB, selfCB);
    //
    // // throw new Error('cacat')
    // // // .then((r) => {
    // // //     console.sendLog('r', r);
    // // //     if (!r.ok) {
    // // //         return {error: r.statusText, status: r.status};
    // // //     }
    // // //
    // // //     return r.json();
    // // // })
    // //     .then((r) => {
    // //
    // //     }).catch((e) => {
    // //     console.sendLog('e', e);
    // //     e.then((er) => {
    // //         console.sendLog('er', er);
    // //         jQuery.ajax('/add-sendLog', {
    // //             method: 'POST',
    // //             body: JSON.stringify({error: er.toString()}, false, 4),
    // //             headers: {
    // //                 'content-type': 'application/json'
    // //             },
    // //         });
    // //     })
    // //
    // // });
</script>
<noscript>no js run</noscript>

</body>
</html>